<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ì „ë¼ë‚¨ë„ ë†ì¶•ì‚°ë¬¼ ëª©ë¡</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body class="bg-light p-4">

<div class="container">
    <h1 class="mb-4">ğŸ¥¬ ì „ë¼ë‚¨ë„ ë†ì¶•ì‚°ë¬¼ ëª©ë¡</h1>

    <!-- ğŸ” ê²€ìƒ‰/í•„í„° í¼ -->
    <form id="filterForm" class="row g-2 mb-4">
        <div class="col-md-3">
            <input type="text" class="form-control" id="areaInput" placeholder="ì§€ì—­ (ì˜ˆ: ë‚˜ì£¼)">
        </div>
        <div class="col-md-3">
            <input type="text" class="form-control" id="searchInput" placeholder="ìƒí’ˆëª… ë˜ëŠ” ì—…ì²´ëª…">
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-primary w-100">ê²€ìƒ‰</button>
        </div>
        <div class="col-md-2">
            <button type="button" id="resetBtn" class="btn btn-secondary w-100">ì´ˆê¸°í™”</button>
        </div>
    </form>

    <!-- ğŸ“‹ ë°ì´í„° í…Œì´ë¸” -->
    <table class="table table-bordered table-hover bg-white">
        <thead class="table-light">
        <tr>
            <th>ë“±ë¡ë²ˆí˜¸</th>
            <th>ìƒí’ˆëª…</th>
            <th>ë“±ë¡ì¼ì</th>
            <th>ì§€ì—­</th>
            <th>ê³„íš ìƒì‚°ëŸ‰</th>
            <th>ì—…ì²´ëª…</th>
            <th>ê¸°ì¤€ì¼ì</th>
        </tr>
        </thead>
        <tbody id="productTableBody">
        <!-- JSì—ì„œ ì‚½ì… -->
        </tbody>
    </table>
</div>

<script>
    // ğŸ“¦ í˜ì´ì§€ ë¡œë“œì‹œ ì „ì²´ ë°ì´í„° ë¡œë”©
    $(document).ready(function () {
        loadProducts();

        // ğŸ” ê²€ìƒ‰ í•„í„° ì´ë²¤íŠ¸
        $('#filterForm').on('submit', function (e) {
            e.preventDefault();
            const area = $('#areaInput').val();
            const search = $('#searchInput').val();
            loadProducts(area, search);
        });

        // ğŸ”„ ì´ˆê¸°í™” ë²„íŠ¼
        $('#resetBtn').on('click', function () {
            $('#areaInput').val('');
            $('#searchInput').val('');
            loadProducts();
        });
    });

    // ğŸ“¥ AJAXë¡œ ì„œë²„ì—ì„œ ì œí’ˆ ë¦¬ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°
    function loadProducts(area = '', search = '') {
        $.ajax({
            url: '/products',
            type: 'GET',
            data: {area: area, search: search},
            success: function (data) {
                const tbody = $('#productTableBody');
                tbody.empty();

                if (data.length === 0) {
                    tbody.append('<tr><td colspan="7" class="text-center text-muted">ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>');
                    return;
                }

                data.forEach(function (item) {
                    const row = `
                        <tr>
                            <td>${item.proRegNo}</td>
                            <td>${item.proName}</td>
                            <td>${item.proRegDate}</td>
                            <td>${item.proArea}</td>
                            <td>${item.proPlanQty}</td>
                            <td>${item.proCompany}</td>
                            <td>${item.proBaseDate}</td>
                        </tr>`;
                    tbody.append(row);
                });
            },
            error: function () {
                alert("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            }
        });
    }
</script>

</body>
</html>
