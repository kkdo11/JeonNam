    <!DOCTYPE html>
    <html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>íšŒì›ê°€ì… - ì „ë‚¨ ì˜í™”/ë“œë¼ë§ˆ ì—¬í–‰</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <style>
            body {
                padding-top: 50px;
                background-color: #f8f9fa;
            }
            .register-container {
                max-width: 700px;
                margin: 0 auto;
                padding: 30px;
                background-color: #fff;
                border-radius: 10px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            }
            /* ìœ íš¨ì„± ê²€ì‚¬ í”¼ë“œë°± ìŠ¤íƒ€ì¼ */
            .is-invalid { border-color: #dc3545 !important; }
            .is-valid { border-color: #28a745 !important; }
            .invalid-feedback { display: block; color: #dc3545; font-size: 0.875em; margin-top: 0.25rem; }
            .valid-feedback { display: block; color: #28a745; font-size: 0.875em; margin-top: 0.25rem; }

            /* ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬ íŒ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
            .password-validation-tip {
                font-size: 0.85em;
                color: #6c757d; /* íšŒìƒ‰ í…ìŠ¤íŠ¸ */
                margin-top: 5px;
            }
            .validation-fail {
                color: red;
            }
            .validation-success {
                color: green;
            }
        </style>
    </head>
    <body>
    <div class="container register-container">
        <h2 class="text-center mb-4">íšŒì›ê°€ì…</h2>
        <form id="userRegForm" action="/account/insertUserInfo" method="post">
            <div class="mb-3">
                <label for="email" class="form-label">ì´ë©”ì¼ <span class="text-danger">*</span></label>
                <div class="input-group">
                    <input type="email" class="form-control" id="email" name="email" placeholder="ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥" required>
                    <button class="btn btn-outline-secondary" type="button" id="checkEmailBtn">ì¤‘ë³µ í™•ì¸</button>
                    <button class="btn btn-outline-primary ms-2" type="button" id="sendVerificationEmailBtn">ì¸ì¦ ë©”ì¼ ì „ì†¡</button>
                </div>
                <div id="emailFeedback" class="invalid-feedback"></div>
            </div>

            <div class="mb-3">
                <label for="verificationCode" class="form-label">ì¸ì¦ ì½”ë“œ <span class="text-danger">*</span></label>
                <div class="input-group">
                    <input type="text" class="form-control" id="verificationCode" name="verificationCode" placeholder="ì¸ì¦ ì½”ë“œ ì…ë ¥" required disabled>
                    <button class="btn btn-outline-success" type="button" id="verifyEmailCodeBtn" disabled>ì½”ë“œ í™•ì¸</button>
                </div>
                <div id="verificationCodeFeedback" class="invalid-feedback"></div>
            </div>

            <div class="mb-3">
                <label for="password" class="form-label">ë¹„ë°€ë²ˆí˜¸ <span class="text-danger">*</span></label>
                <input type="password" class="form-control" id="password" name="password" placeholder="8~20ì, ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì í¬í•¨" required>
                <div id="passwordFeedback" class="invalid-feedback"></div>
            </div>

            <div class="mb-3">
                <label for="confirmPassword" class="form-label">ë¹„ë°€ë²ˆí˜¸ í™•ì¸ <span class="text-danger">*</span></label>
                <input type="password" class="form-control" id="confirmPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥" required>
                <div id="confirmPasswordFeedback" class="invalid-feedback"></div>
            </div>

            <div class="mb-3">
                <label for="name" class="form-label">ì´ë¦„ <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="name" name="name" placeholder="ì´ë¦„ ì…ë ¥" required>
                <div id="nameFeedback" class="invalid-feedback"></div>
            </div>

            <div class="mb-3">
                <label for="birthDate" class="form-label">ìƒë…„ì›”ì¼ <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="birthDate" name="birthDate"
                       placeholder="YYYYMMDD (ì˜ˆ: 19900115)" maxlength="8" required>
                <div id="birthDateFeedback" class="invalid-feedback"></div>
                <div class="form-text mt-2">ìƒë…„ì›”ì¼ 8ìë¦¬ë¥¼ ìˆ«ìë§Œ ì…ë ¥í•´ì£¼ì„¸ìš” (ì˜ˆ: 19900115).</div>
            </div>
            <div class="mb-3">
                <label for="phoneNum" class="form-label">íœ´ëŒ€í° ë²ˆí˜¸ <span class="text-danger">*</span></label>
                <input type="tel" class="form-control" id="phoneNum" name="phoneNum"
                       placeholder="í•˜ì´í”ˆ ì—†ì´ ìˆ«ìë§Œ ì…ë ¥ (ì˜ˆ: 01012345678)" required>
                <div id="phoneNumFeedback" class="invalid-feedback"></div>
                <div class="form-text mt-2">í•˜ì´í”ˆ(-) ì—†ì´ ìˆ«ìë§Œ ì…ë ¥í•´ì£¼ì„¸ìš” (010ìœ¼ë¡œ ì‹œì‘).</div>
            </div>
            <div class="mb-3">
                <label for="sex" class="form-label">ì„±ë³„ <span class="text-danger">*</span></label>
                <select class="form-select" id="sex" name="sex" required>
                    <option value="">ì„ íƒ</option>
                    <option value="M">ë‚¨</option>
                    <option value="F">ì—¬</option>
                </select>
                <div id="sexFeedback" class="invalid-feedback"></div>
            </div>

            <div class="mb-3">
                <label for="country" class="form-label">êµ­ê°€ <span class="text-danger">*</span></label>
                <select class="form-select" id="country" name="country" required>
                    <option value="">ì„ íƒ</option>
                    <option value="KR">ëŒ€í•œë¯¼êµ­</option>
                    <option value="US">ë¯¸êµ­</option>
                    <option value="JP">ì¼ë³¸</option>
                    <option value="CN">ì¤‘êµ­</option>
                    <option value="ETC">ê¸°íƒ€</option>
                </select>
                <div id="countryFeedback" class="invalid-feedback"></div>
            </div>

            <button type="submit" class="btn btn-primary w-100" id="submitBtn">íšŒì›ê°€ì…</button>
        </form>
        <div class="mt-3 text-center">
            ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? <a href="/user/login">ë¡œê·¸ì¸</a>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™” (ê¸°ì¡´ê³¼ ë™ì¼)
        let isEmailValid = false;
        let isEmailVerified = false;
        let isPasswordValid = false;
        let isConfirmPasswordValid = false;
        let isNameValid = false;
        let isBirthDateValid = false; // ìƒë…„ì›”ì¼ ìœ íš¨ì„± ë³€ìˆ˜
        let isPhoneNumValid = false;   // íœ´ëŒ€í° ë²ˆí˜¸ ìœ íš¨ì„± ë³€ìˆ˜
        let isSexValid = false;
        let isCountryValid = false;

        // í”¼ë“œë°± ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜ (ê¸°ì¡´ê³¼ ë™ì¼)
        function showFeedback(fieldId, message, isValid) {
            const feedbackElement = $(`#${fieldId}Feedback`);
            const inputElement = $(`#${fieldId}`);

            if (isValid) {
                inputElement.removeClass('is-invalid').addClass('is-valid');
                feedbackElement.text('');
            } else {
                inputElement.removeClass('is-valid').addClass('is-invalid');
                feedbackElement.text(message);
            }
        }

        // ëª¨ë“  í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ ë° ë²„íŠ¼ í™œì„±í™” í•¨ìˆ˜ (ê¸°ì¡´ê³¼ ë™ì¼)
        function checkFormValidity() {
            const isFormValid = isEmailValid && isEmailVerified && isPasswordValid && isConfirmPasswordValid &&
                isNameValid && isBirthDateValid && isPhoneNumValid && isSexValid && isCountryValid;
            $('#submitBtn').prop('disabled', !isFormValid);
            return isFormValid;
        }

        // ì´ë©”ì¼ ì…ë ¥ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ (ê¸°ì¡´ê³¼ ë™ì¼)
        $('#email').on('keyup change', function() {
            const email = $(this).val().trim();
            const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
            if (email.length === 0) {
                showFeedback('email', 'ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', false);
                isEmailValid = false;
            } else if (!emailRegex.test(email)) {
                showFeedback('email', 'ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', false);
                isEmailValid = false;
            } else {
                showFeedback('email', '', true);
                isEmailValid = true;
            }
            isEmailVerified = false; // ì´ë©”ì¼ ë³€ê²½ ì‹œ ì¸ì¦ ìƒíƒœ ì´ˆê¸°í™”
            $('#verificationCode').prop('disabled', true).val(''); // ì¸ì¦ ì½”ë“œ ì´ˆê¸°í™” ë° ë¹„í™œì„±í™”
            $('#verifyEmailCodeBtn').prop('disabled', true).text('ì½”ë“œ í™•ì¸');
            checkFormValidity();
        });

        // ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ (ê¸°ì¡´ê³¼ ë™ì¼)
        $('#checkEmailBtn').on('click', function() {
            const email = $('#email').val().trim();
            if (!isEmailValid) {
                alert('ìœ íš¨í•œ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            $.ajax({
                url: '/account/getEmailExists',
                type: 'POST',
                data: { email: email },
                success: function(response) {
                    if (response.exist_yn === 'Y') {
                        showFeedback('email', 'ì´ë¯¸ ê°€ì…ëœ ì´ë©”ì¼ ì£¼ì†Œì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì´ë©”ì¼ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”.', false);
                        isEmailValid = false; // ì¤‘ë³µì´ë©´ ìœ íš¨í•˜ì§€ ì•ŠìŒ
                        isEmailVerified = false;
                    } else {
                        showFeedback('email', 'ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ ì£¼ì†Œì…ë‹ˆë‹¤.', true);
                        isEmailValid = true; // ì‚¬ìš© ê°€ëŠ¥í•˜ë©´ ìœ íš¨í•¨
                        // ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ í›„ ì¸ì¦ ê´€ë ¨ í•„ë“œ í™œì„±í™”
                        $('#email').prop('disabled', true); // ì¤‘ë³µ í™•ì¸ í›„ ì´ë©”ì¼ í•„ë“œ ë¹„í™œì„±í™”
                        $('#checkEmailBtn').prop('disabled', true); // ì¤‘ë³µ í™•ì¸ ë²„íŠ¼ ë¹„í™œì„±í™”
                        $('#sendVerificationEmailBtn').prop('disabled', false); // ì¸ì¦ ë©”ì¼ ì „ì†¡ ë²„íŠ¼ í™œì„±í™”
                        $('#verificationCode').prop('disabled', false); // ì¸ì¦ ì½”ë“œ í•„ë“œ í™œì„±í™”
                    }
                    checkFormValidity();
                },
                error: function() {
                    showFeedback('email', 'ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', false);
                    isEmailValid = false;
                    checkFormValidity();
                }
            });
        });

        // ì¸ì¦ ë©”ì¼ ì „ì†¡ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ (ê¸°ì¡´ê³¼ ë™ì¼)
        $('#sendVerificationEmailBtn').on('click', function() {
            const email = $('#email').val().trim();
            if (!email) {
                alert('ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            $('#sendVerificationEmailBtn').prop('disabled', true).text('ì „ì†¡ ì¤‘...'); // ë²„íŠ¼ ë¹„í™œì„±í™” ë° í…ìŠ¤íŠ¸ ë³€ê²½

            $.ajax({
                url: '/account/sendVerificationEmail',
                type: 'POST',
                data: { email: email },
                success: function(response) {
                    if (response.result === 1) {
                        alert(response.msg);
                        $('#verifyEmailCodeBtn').prop('disabled', false); // ì½”ë“œ í™•ì¸ ë²„íŠ¼ í™œì„±í™”
                        $('#sendVerificationEmailBtn').text('ì¬ì „ì†¡'); // í…ìŠ¤íŠ¸ ë³€ê²½
                    } else {
                        alert(response.msg);
                        $('#sendVerificationEmailBtn').prop('disabled', false).text('ì¬ì „ì†¡'); // ì „ì†¡ ì‹¤íŒ¨ ì‹œ ë‹¤ì‹œ í™œì„±í™”
                    }
                },
                error: function() {
                    alert('ì¸ì¦ ë©”ì¼ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                    $('#sendVerificationEmailBtn').prop('disabled', false).text('ì¬ì „ì†¡');
                }
            });
        });

        // ì¸ì¦ ì½”ë“œ í™•ì¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ (ê¸°ì¡´ê³¼ ë™ì¼)
        $('#verifyEmailCodeBtn').on('click', function() {
            const email = $('#email').val().trim();
            const code = $('#verificationCode').val().trim();

            if (!email || !code) {
                alert('ì´ë©”ì¼ê³¼ ì¸ì¦ ì½”ë“œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            $('#verifyEmailCodeBtn').prop('disabled', true).text('í™•ì¸ ì¤‘...'); // ë²„íŠ¼ ë¹„í™œì„±í™” ë° í…ìŠ¤íŠ¸ ë³€ê²½

            $.ajax({
                url: '/account/verifyEmailCode',
                type: 'POST',
                data: { email: email, code: code },
                success: function(response) {
                    if (response.result === 1) {
                        alert(response.msg);
                        showFeedback('verificationCode', 'ì¸ì¦ ì„±ê³µ!', true);
                        isEmailVerified = true;
                        // ì¸ì¦ ì„±ê³µ í›„ ê´€ë ¨ í•„ë“œ ëª¨ë‘ ë¹„í™œì„±í™”
                        $('#email').prop('disabled', true);
                        $('#checkEmailBtn').prop('disabled', true);
                        $('#sendVerificationEmailBtn').prop('disabled', true).text('ì¸ì¦ ì™„ë£Œ');
                        $('#verificationCode').prop('disabled', true);
                        $('#verifyEmailCodeBtn').prop('disabled', true).text('ì¸ì¦ ì™„ë£Œ');
                    } else {
                        alert(response.msg);
                        showFeedback('verificationCode', response.msg, false);
                        isEmailVerified = false;
                        $('#verifyEmailCodeBtn').prop('disabled', false).text('ì½”ë“œ í™•ì¸'); // ì‹¤íŒ¨ ì‹œ ì¬í™œì„±í™”
                    }
                    checkFormValidity();
                },
                error: function() {
                    alert('ì¸ì¦ ì½”ë“œ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                    isEmailVerified = false;
                    $('#verifyEmailCodeBtn').prop('disabled', false).text('ì½”ë“œ í™•ì¸');
                    checkFormValidity();
                }
            });
        });

        // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ (ê¸°ì¡´ê³¼ ë™ì¼)
        $('#password').on('keyup change', function() {
            const password = $(this).val();
            const passwordRegex = /^(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[!@#$%^&+=]).*$/;
            if (password.length < 8 || password.length > 20) {
                showFeedback('password', 'ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒ 20ì ì´í•˜ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.', false);
                isPasswordValid = false;
            } else if (!passwordRegex.test(password)) {
                showFeedback('password', 'ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.', false);
                isPasswordValid = false;
            } else {
                showFeedback('password', '', true);
                isPasswordValid = true;
            }
            // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œ í™•ì¸ ë¹„ë°€ë²ˆí˜¸ë„ ë‹¤ì‹œ ê²€ì‚¬
            $('#confirmPassword').trigger('keyup');
            checkFormValidity();
        });

        // ë¹„ë°€ë²ˆí˜¸ í™•ì¸ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ (ê¸°ì¡´ê³¼ ë™ì¼)
        $('#confirmPassword').on('keyup change', function() {
            const password = $('#password').val();
            const confirmPassword = $(this).val();
            if (confirmPassword.length === 0) {
                showFeedback('confirmPassword', 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.', false);
                isConfirmPasswordValid = false;
            } else if (password !== confirmPassword) {
                showFeedback('confirmPassword', 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', false);
                isConfirmPasswordValid = false;
            } else {
                showFeedback('confirmPassword', '', true);
                isConfirmPasswordValid = true;
            }
            checkFormValidity();
        });

        // ì´ë¦„ ì…ë ¥ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ (ê¸°ì¡´ê³¼ ë™ì¼)
        $('#name').on('keyup change', function() {
            const name = $(this).val().trim();
            if (name.length === 0) {
                showFeedback('name', 'ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', false);
                isNameValid = false;
            } else {
                showFeedback('name', '', true);
                isNameValid = true;
            }
            checkFormValidity();
        });

        // ğŸŒŸğŸŒŸğŸŒŸ ìƒë…„ì›”ì¼ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ ë¦¬íŒ©í† ë§ ì‹œì‘ ğŸŒŸğŸŒŸğŸŒŸ
        $('#birthDate').on('keyup', function() { // on 'change' ëŒ€ì‹  'keyup' ì‚¬ìš©
            const birthDate = $(this).val().trim();
            const birthDateRegex = /^\d{8}$/; // 8ìë¦¬ ìˆ«ìë§Œ í—ˆìš©í•˜ëŠ” ì •ê·œì‹

            if (birthDate.length === 0) {
                showFeedback('birthDate', 'ìƒë…„ì›”ì¼ 8ìë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', false);
                isBirthDateValid = false;
            } else if (!birthDateRegex.test(birthDate)) {
                showFeedback('birthDate', 'ìƒë…„ì›”ì¼ì€ 8ìë¦¬ ìˆ«ì(YYYYMMDD) í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤.', false);
                isBirthDateValid = false;
            } else {
                // ì¶”ê°€ì ìœ¼ë¡œ ìœ íš¨í•œ ë‚ ì§œì¸ì§€ (ì˜ˆ: 2ì›” 30ì¼ ê°™ì€ ì˜¤ë¥˜) ê²€ì‚¬í•  ìˆ˜ ìˆì§€ë§Œ,
                // í˜„ì¬ ì„œë²„ ìœ íš¨ì„± ê²€ì‚¬ê°€ ìˆ«ì 8ìë¦¬ì— ì´ˆì  ë§ì¶°ì ¸ ìˆìœ¼ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ìƒëµ
                showFeedback('birthDate', '', true);
                isBirthDateValid = true;
            }
            checkFormValidity();
        }).trigger('keyup'); // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìœ íš¨ì„± ê²€ì‚¬ ì‹¤í–‰
        // ğŸŒŸğŸŒŸğŸŒŸ ìƒë…„ì›”ì¼ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ ë¦¬íŒ©í† ë§ ë ğŸŒŸğŸŒŸğŸŒŸ

        // ğŸŒŸğŸŒŸğŸŒŸ íœ´ëŒ€í° ë²ˆí˜¸ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ ë¦¬íŒ©í† ë§ ì‹œì‘ ğŸŒŸğŸŒŸğŸŒŸ
        $('#phoneNum').on('keyup', function() { // on 'change' ëŒ€ì‹  'keyup' ì‚¬ìš©
            const phoneNum = $(this).val().trim();
            // ì„œë²„ DTOì˜ ì •ê·œì‹ê³¼ ë™ì¼í•˜ê²Œ í•˜ì´í”ˆ ì—†ëŠ” ìˆ«ìë§Œ ê²€ì‚¬
            const phoneRegex = /^(010|011|016|017|018|019)\d{7,8}$/; // 01X + 7~8ìë¦¬ ìˆ«ì

            if (phoneNum.length === 0) {
                showFeedback('phoneNum', 'íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', false);
                isPhoneNumValid = false;
            } else if (!phoneRegex.test(phoneNum)) {
                showFeedback('phoneNum', 'ì˜¬ë°”ë¥¸ íœ´ëŒ€í° ë²ˆí˜¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (í•˜ì´í”ˆ ì—†ì´ ìˆ«ìë§Œ)', false);
                isPhoneNumValid = false;
            } else {
                showFeedback('phoneNum', '', true);
                isPhoneNumValid = true;
            }
            checkFormValidity();
        }).trigger('keyup'); // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìœ íš¨ì„± ê²€ì‚¬ ì‹¤í–‰
        // ğŸŒŸğŸŒŸğŸŒŸ íœ´ëŒ€í° ë²ˆí˜¸ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ ë¦¬íŒ©í† ë§ ë ğŸŒŸğŸŒŸğŸŒŸ

        // ì„±ë³„ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ (ê¸°ì¡´ê³¼ ë™ì¼)
        $('#sex').on('change', function() {
            if ($(this).val() === '') {
                showFeedback('sex', 'ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', false);
                isSexValid = false;
            } else {
                showFeedback('sex', '', true);
                isSexValid = true;
            }
            checkFormValidity();
        }).trigger('change'); // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìœ íš¨ì„± ê²€ì‚¬ ì‹¤í–‰

        // êµ­ê°€ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ (ê¸°ì¡´ê³¼ ë™ì¼)
        $('#country').on('change', function() {
            if ($(this).val() === '') {
                showFeedback('country', 'êµ­ê°€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', false);
                isCountryValid = false;
            } else {
                showFeedback('country', '', true);
                isCountryValid = true;
            }
            checkFormValidity();
        }).trigger('change'); // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìœ íš¨ì„± ê²€ì‚¬ ì‹¤í–‰

        // í¼ ì œì¶œ ì´ë²¤íŠ¸ (ê¸°ì¡´ê³¼ ë™ì¼, ìƒë…„ì›”ì¼/íœ´ëŒ€í° ë²ˆí˜¸ ê°€ê³µ ë¡œì§ ì œê±°)
        $('#userRegForm').on('submit', function(event) {
            event.preventDefault(); // ê¸°ë³¸ í¼ ì œì¶œ ë°©ì§€

            // ìµœì¢… ìœ íš¨ì„± ê²€ì‚¬ (ëª¨ë“  í•„ë“œ ìœ íš¨ì„± ë° ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ)
            if (!checkFormValidity()) {
                alert('ëª¨ë“  í•„ìˆ˜ ì •ë³´ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•˜ê³  ì´ë©”ì¼ ì¸ì¦ì„ ì™„ë£Œí•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            // ğŸŒŸğŸŒŸğŸŒŸ ìƒë…„ì›”ì¼/íœ´ëŒ€í° ë²ˆí˜¸ ë°ì´í„° ê°€ê³µ ë¡œì§ ì œê±°! ğŸŒŸğŸŒŸğŸŒŸ
            // ì´ì œ ì…ë ¥ í•„ë“œì—ì„œ ê°’ì„ ê°€ì ¸ì˜¬ ë•Œ ê·¸ëŒ€ë¡œ ì‚¬ìš©!
            // (ì‚¬ìš©ìê°€ ì´ë¯¸ í•˜ì´í”ˆ ì—†ì´ ìˆ«ìë§Œ ì…ë ¥í–ˆë‹¤ê³  ê°€ì •)

            const jsonData = {
                email: $('#email').val(),
                password: $('#password').val(),
                name: $('#name').val(),
                birthDate: $('#birthDate').val(), // â­ ê·¸ëŒ€ë¡œ ì‚¬ìš© â­
                phoneNum: $('#phoneNum').val(),   // â­ ê·¸ëŒ€ë¡œ ì‚¬ìš© â­
                sex: $('#sex').val(),
                country: $('#country').val(),
                verificationCode: $('#verificationCode').val()
            };

            $.ajax({
                url: $(this).attr('action'),
                type: $(this).attr('method'),
                contentType: 'application/json',
                data: JSON.stringify(jsonData),
                success: function(response) {
                    if (response.result === 1) {
                        alert(response.msg);
                        location.href = '/user/login';
                    } else {
                        alert(response.msg);
                        // ì‹¤íŒ¨ ì‹œ ê´€ë ¨ í•„ë“œ ë° ë²„íŠ¼ ì¬í™œì„±í™”
                        $('#email').prop('disabled', false);
                        $('#checkEmailBtn').prop('disabled', false);
                        $('#sendVerificationEmailBtn').prop('disabled', false).text('ì¸ì¦ ë©”ì¼ ì „ì†¡');
                        $('#verificationCode').prop('disabled', false);
                        $('#verifyEmailCodeBtn').prop('disabled', false).text('ì½”ë“œ í™•ì¸');
                        isEmailVerified = false; // ì¸ì¦ ì‹¤íŒ¨í–ˆìœ¼ë‹ˆ ìƒíƒœ ì´ˆê¸°í™”
                        checkFormValidity(); // í¼ ìœ íš¨ì„± ë‹¤ì‹œ ê²€ì‚¬í•˜ì—¬ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
                    }
                },
                error: function(xhr) {
                    alert("íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                    // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ í•„ë“œ ë° ë²„íŠ¼ ì¬í™œì„±í™”
                    $('#email').prop('disabled', false);
                    $('#checkEmailBtn').prop('disabled', false);
                    $('#sendVerificationEmailBtn').prop('disabled', false).text('ì¸ì¦ ë©”ì¼ ì „ì†¡');
                    $('#verificationCode').prop('disabled', false);
                    $('#verifyEmailCodeBtn').prop('disabled', false).text('ì½”ë“œ í™•ì¸');
                    isEmailVerified = false; // ì¸ì¦ ì‹¤íŒ¨í–ˆìœ¼ë‹ˆ ìƒíƒœ ì´ˆê¸°í™”
                    checkFormValidity();
                }
            });
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìœ íš¨ì„± ê²€ì‚¬ ì‹¤í–‰ (ëª¨ë“  í•„ë“œ)
        $(document).ready(function() {
            $('#email').trigger('keyup');
            $('#password').trigger('keyup');
            $('#confirmPassword').trigger('keyup');
            $('#name').trigger('keyup');
            // ìƒë…„ì›”ì¼ê³¼ íœ´ëŒ€í° ë²ˆí˜¸ë„ ì´ˆê¸° ìœ íš¨ì„± ê²€ì‚¬ ì‹¤í–‰
            $('#birthDate').trigger('keyup');
            $('#phoneNum').trigger('keyup');
            $('#sex').trigger('change');
            $('#country').trigger('change');
        });

    </script>

    </body>
    </html>